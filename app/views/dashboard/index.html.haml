.h-screen.overflow-hidden.notice-board-gradient{ data: { controller: 'notice-board display-mode' } }
  .flex.flex-col.gap-3.sm:gap-4.md:gap-5.p-3.sm:p-4.md:p-5.h-full

    / Top row - Two announcement boxes (stack on mobile, side-by-side on desktop)
    %div{ class: 'flex flex-col lg:flex-row gap-3 sm:gap-4 md:gap-8 flex-[9]' }
      / General announcements (left - 65% on desktop, full width on mobile)
      %div{ class: 'lg:flex-[65] flex-1', data: { display_mode_target: 'generalBox' } }
        = render Display::CarouselBoxComponent.new(title: 'Ogłoszenia Ogólne', posts: @general_posts, empty_message: 'Brak ogłoszeń', box_classes: 'h-full')

      / Location announcements (right - 35% on desktop, full width on mobile)
      - location_title = @location ? "Ogłoszenia - #{@location.name}" : 'Ogłoszenia Oddziałowe'
      - location_empty = @location ? 'Brak ogłoszeń dla tego oddziału' : 'Wybierz oddział aby zobaczyć ogłoszenia'
      %div{ class: 'lg:flex-[35] flex-1', data: { display_mode_target: 'locationBox' } }
        = render Display::CarouselBoxComponent.new(title: location_title, posts: @location_posts, empty_message: location_empty, box_classes: 'h-full')

    / Bottom row - RSS marquee
    = render Display::MarqueeComponent.new(rss_feed_items: @rss_feed_items, logo_url: AppConfig::LOGO_URL)

  / Hidden menu trigger area (bottom-right corner)
  %div{ class: 'fixed bottom-0 right-0 w-16 h-16 cursor-pointer z-40', data: { display_mode_target: 'trigger', action: 'click->display-mode#openMenuFromTrigger' }, title: 'Click to open display settings (or press M)' }

  / Hidden settings menu
  %div{ class: 'fixed inset-0 bg-black bg-opacity-50 items-center justify-center z-50 hidden opacity-0 scale-95 transition-all duration-200', data: { display_mode_target: 'menu', action: 'click->display-mode#closeMenu' } }
    %div{ class: 'bg-white rounded-lg shadow-2xl p-8 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto', data: { action: 'click->display-mode#preventClose' } }
      %h2{ class: 'text-2xl font-bold text-gray-800 mb-6 text-center' } Ustawienia Wyświetlania

      / Display mode section
      %h3{ class: 'text-lg font-semibold text-gray-700 mb-3' } Tryb Wyświetlania
      %div{ class: 'space-y-3 mb-6' }
        / Default mode button
        %button{ type: 'button', class: 'w-full bg-orange-500 hover:bg-orange-600 text-white font-semibold py-4 px-6 rounded-lg transition-colors duration-200 flex items-center justify-between', data: { mode: 'default', action: 'click->display-mode#setMode' } }
          %span Domyślny (Oba okna)
          %svg{ class: 'w-6 h-6', fill: 'none', stroke: 'currentColor', viewBox: '0 0 24 24' }
            %path{ 'stroke-linecap' => 'round', 'stroke-linejoin' => 'round', 'stroke-width' => '2', d: 'M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7' }

        / General only mode button
        %button{ type: 'button', class: 'w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-4 px-6 rounded-lg transition-colors duration-200 flex items-center justify-between', data: { mode: 'general-only', action: 'click->display-mode#setMode' } }
          %span Tylko Ogólne (Pełny ekran)
          %svg{ class: 'w-6 h-6', fill: 'none', stroke: 'currentColor', viewBox: '0 0 24 24' }
            %path{ 'stroke-linecap' => 'round', 'stroke-linejoin' => 'round', 'stroke-width' => '2', d: 'M4 5a1 1 0 011-1h14a1 1 0 011 1v14a1 1 0 01-1 1H5a1 1 0 01-1-1V5z' }

        / Location only mode button
        %button{ type: 'button', class: 'w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-4 px-6 rounded-lg transition-colors duration-200 flex items-center justify-between', data: { mode: 'location-only', action: 'click->display-mode#setMode' } }
          %span Tylko Oddziałowe (Pełny ekran)
          %svg{ class: 'w-6 h-6', fill: 'none', stroke: 'currentColor', viewBox: '0 0 24 24' }
            %path{ 'stroke-linecap' => 'round', 'stroke-linejoin' => 'round', 'stroke-width' => '2', d: 'M4 5a1 1 0 011-1h14a1 1 0 011 1v14a1 1 0 01-1 1H5a1 1 0 01-1-1V5z' }

      / Location selector section
      %div{ class: 'border-t border-gray-200 pt-6' }
        %h3{ class: 'text-lg font-semibold text-gray-700 mb-3' } Wybierz Oddział

        / Current location display
        %div{ class: 'mb-3 p-3 bg-gray-50 rounded-lg text-sm' }
          %span{ class: 'text-gray-600' } Aktualny oddział:
          %span{ class: 'font-semibold text-gray-800 ml-2', data: { display_mode_target: 'currentLocation' } }
            = @location ? @location.full_name : 'Nie wybrano'

        / Toggle button
        %button{ type: 'button', class: 'w-full bg-purple-500 hover:bg-purple-600 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200 flex items-center justify-between', data: { action: 'click->display-mode#toggleLocationList' } }
          %span Pokaż listę oddziałów
          %svg{ class: 'w-5 h-5 transform transition-transform duration-200', data: { display_mode_target: 'locationArrow' }, fill: 'none', stroke: 'currentColor', viewBox: '0 0 24 24' }
            %path{ 'stroke-linecap' => 'round', 'stroke-linejoin' => 'round', 'stroke-width' => '2', d: 'M19 9l-7 7-7-7' }

        / Location list (collapsible)
        %div{ class: 'hidden mt-3 max-h-48 overflow-y-auto border border-gray-200 rounded-lg', data: { display_mode_target: 'locationList' } }
          - if @locations.any?
            / Clear location button
            %button{ type: 'button', class: 'w-full text-left px-4 py-3 hover:bg-gray-100 transition-colors duration-150 border-b border-gray-200 text-sm font-medium text-red-600', data: { action: 'click->display-mode#clearLocation' } }
              ✕ Wyczyść wybór oddziału

            / Location list items
            - @locations.each do |location|
              %button{ type: 'button', class: "w-full text-left px-4 py-3 hover:bg-purple-50 transition-colors duration-150 border-b border-gray-200 last:border-b-0 #{'bg-purple-100 font-semibold' if @location&.id == location.id}", data: { action: 'click->display-mode#selectLocation', location_id: location.id, location_name: location.full_name } }
                = location.full_name
          - else
            %div{ class: 'px-4 py-3 text-sm text-gray-500 text-center' }
              Brak dostępnych oddziałów

      / Close button
      %button{ type: 'button', class: 'w-full mt-6 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-3 px-6 rounded-lg transition-colors duration-200', data: { action: 'click->display-mode#closeMenu' } }
        Zamknij

      %p{ class: 'text-sm text-gray-500 text-center mt-4' } Wskazówka: Naciśnij 'M' aby otworzyć to menu